$(function(){var t={init:function(){t.setLikeInfo(),t.bindLike()},setLikeInfo:function(){var t=$("h2"),n={obj_type:t.attr("data-type"),ids:t.attr("data-id")};a.getLikeInfo({data:n},function(a){var n=$(".like-no"),i=t.attr("data-id"),e=$(".icon-thumbs-up");n.html(a.data[i].prai_count),null!==a.data[i].has_prai&&1===a.data[i].has_prai&&e.addClass("like")})},bindLike:function(){var t=$("h2"),n=$(".icon-thumbs-up"),i={obj_type:t.attr("data-type"),obj_id:t.attr("data-id")};n.off("click").on("click",function(){var t=$(".like-no"),e=t.html(),c=$(".share").attr("data-user"),o=void 0!==c&&""!==c;o?n.hasClass("like")?a.cancelLike({data:i},function(){t.html(parseInt(e)-1),n.removeClass("like")}):a.clickLike({data:i},function(){t.html(parseInt(e)+1),n.addClass("like")}):IOT.tips(IOT.tr("您尚未登录"),"warning")})}},a={clickLike:function(t,a){$.ajax($.extend({type:"POST",url:IOT.i18nS+"/praise",dataType:"JSON"},t,!0)).done(function(t){t&&$.isFunction(a)&&a(t)})},cancelLike:function(t,a){$.ajax($.extend({type:"POST",url:IOT.i18nS+"/praise/cancel",dataType:"JSON"},t,!0)).done(function(t){t&&$.isFunction(a)&&a(t)})},getLikeInfo:function(t,a){$.ajax($.extend({type:"POST",url:IOT.i18nS+"/praise/checkcount",dataType:"JSON"},t,!0)).done(function(t){t&&$.isFunction(a)&&a(t)})}};t.init()});